# å¾®ä¿¡æ”¯ä»˜ç§¯åˆ†ç³»ç»Ÿ

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Node Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen.svg)](.nvmrc)
[![Production](https://img.shields.io/badge/status-production-success.svg)](https://www.guandongfang.cn/admin/)

> åŸºäºå¾®ä¿¡æ”¯ä»˜çš„ç§¯åˆ†èµ é€ç³»ç»Ÿï¼Œç”¨æˆ·é€šè¿‡æ‰«ç æ”¯ä»˜åè‡ªåŠ¨è·å¾—1:1ç§¯åˆ†å¥–åŠ±ã€‚åŒ…å«å®Œæ•´çš„ç®¡ç†åå°å’Œå¾®ä¿¡å°ç¨‹åºã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **å¾®ä¿¡ç™»å½•æˆæƒ** - å°ç¨‹åºä¸€é”®ç™»å½•
- âœ… **æ‰«ç æ”¯ä»˜åŠŸèƒ½** - å¾®ä¿¡æ”¯ä»˜æ¥å…¥
- âœ… **ç§¯åˆ†è‡ªåŠ¨å‘æ”¾** - æ”¯ä»˜æˆåŠŸå1:1ç§¯åˆ†å¥–åŠ±
- âœ… **ç§¯åˆ†ä½™é¢æŸ¥è¯¢** - å®æ—¶ç§¯åˆ†æŸ¥è¯¢
- âœ… **ç§¯åˆ†è®°å½•ç®¡ç†** - å®Œæ•´çš„ç§¯åˆ†æµæ°´
- âœ… **ç®¡ç†åå°** - ç”¨æˆ·ã€å•†æˆ·ã€è®¢å•ã€ç§¯åˆ†ç®¡ç†
- ğŸš§ **ç§¯åˆ†å•†åŸ** - ç¬¬äºŒæœŸå¼€å‘ä¸­

### åœ¨çº¿è®¿é—®
- **ç®¡ç†åå°**: https://www.guandongfang.cn/admin/
- **ç™»å½•è´¦å·**: admin / admin123
- **æœåŠ¡å™¨**: é˜¿é‡Œäº‘ 8.156.84.226

## ğŸ— æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: React 18 + TypeScript + Ant Design
- **åç«¯**: Node.js + Express.js
- **æ•°æ®åº“**: MySQL 8.0
- **éƒ¨ç½²**: Nginx + PM2 + HTTPS
- **å°ç¨‹åº**: å¾®ä¿¡åŸç”Ÿæ¡†æ¶

### ç³»ç»Ÿæ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾®ä¿¡å°ç¨‹åº      â”‚â”€â”€â”€â”€â–¶â”‚   Nginx (443)    â”‚â”€â”€â”€â”€â–¶â”‚   Node.js   â”‚
â”‚  (ç”¨æˆ·ç«¯)        â”‚     â”‚   åå‘ä»£ç†        â”‚     â”‚  (ç«¯å£3000) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  Reactç®¡ç†åå°   â”‚â”€â”€â”€â”€â–¶â”‚   Nginx (443)    â”‚            â”‚
â”‚  (ç®¡ç†å‘˜ç«¯)      â”‚     â”‚   é™æ€æ–‡ä»¶æœåŠ¡    â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â–¼
                                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                  â”‚   MySQL     â”‚
                                                  â”‚  (ç«¯å£3306) â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
weixinzhifu/
â”œâ”€â”€ backend/                    # åç«¯APIæœåŠ¡
â”‚   â”œâ”€â”€ src/                   # TypeScriptæºç ï¼ˆæœªä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ sql/                   # æ•°æ®åº“è„šæœ¬
â”‚   â”œâ”€â”€ payment-points-api-enhanced.js  # ç”Ÿäº§ç¯å¢ƒåç«¯ï¼ˆâœ…è¿è¡Œä¸­ï¼‰
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ admin-frontend/             # ç®¡ç†åå°å‰ç«¯
â”‚   â”œâ”€â”€ src/                   # Reactæºç 
â”‚   â”œâ”€â”€ build/                 # æ„å»ºäº§ç‰©ï¼ˆâœ…å·²éƒ¨ç½²ï¼‰
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ frontend/miniprogram/       # å¾®ä¿¡å°ç¨‹åº
â”‚   â”œâ”€â”€ pages/                 # é¡µé¢
â”‚   â”œâ”€â”€ components/            # ç»„ä»¶
â”‚   â””â”€â”€ app.js
â”œâ”€â”€ docs/                       # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ 01-éœ€æ±‚æ–‡æ¡£/
â”‚   â”œâ”€â”€ 02-æŠ€æœ¯è®¾è®¡/
â”‚   â””â”€â”€ 10-æ“ä½œæŒ‡å—/
â”œâ”€â”€ scripts/                    # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ deploy-admin-complete.sh
â”‚   â””â”€â”€ deploy-backend-complete.sh
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ nginx/
â”œâ”€â”€ .cursorrules               # Cursor AIè§„åˆ™
â”œâ”€â”€ CHANGELOG.md               # å˜æ›´æ—¥å¿—
â””â”€â”€ README.md                  # æœ¬æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18.0.0
- MySQL >= 8.0
- Nginx (ç”Ÿäº§ç¯å¢ƒ)
- å¾®ä¿¡å¼€å‘è€…å·¥å…·

### æœ¬åœ°å¼€å‘

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone git@github.com:allenxing4071/weixinzhifu.git
cd weixinzhifu
```

#### 2. å®‰è£…ä¾èµ–
```bash
# åç«¯
cd backend
npm install

# å‰ç«¯
cd ../admin-frontend
npm install
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡
```bash
cd backend
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“ç­‰ä¿¡æ¯
```

#### 4. åˆå§‹åŒ–æ•°æ®åº“
```bash
mysql -u root -p < backend/sql/create_all_tables.sql
```

#### 5. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨åç«¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
cd backend
node payment-points-api-enhanced.js

# å¯åŠ¨å‰ç«¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
cd admin-frontend
npm start
```

### å¾®ä¿¡å°ç¨‹åºå¼€å‘

1. **æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·**
2. **å¯¼å…¥é¡¹ç›®**: `frontend/miniprogram`
3. **é…ç½®APIåœ°å€**: 
   - å¼€å‘ç¯å¢ƒ: ä¿®æ”¹ `app.js` ä¸­çš„ `baseUrl`
   - ç”Ÿäº§ç¯å¢ƒ: `https://www.guandongfang.cn/api/v1`
4. **é¢„è§ˆè°ƒè¯•**: ç‚¹å‡»"é¢„è§ˆ"æ‰«ç æµ‹è¯•

## ğŸ“š æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£
- [é¡¹ç›®å®æ–½çŠ¶æ€æ€»ç»“](docs/00-é¡¹ç›®å®æ–½çŠ¶æ€æ€»ç»“.md) - æœ€æ–°è¿›åº¦å’ŒçŠ¶æ€
- [å·²å®ŒæˆåŠŸèƒ½é”å®šæ–‡æ¡£](docs/00-å·²å®ŒæˆåŠŸèƒ½é”å®šæ–‡æ¡£.md) - åŠŸèƒ½æ¸…å•
- [å˜æ›´æ—¥å¿—](CHANGELOG.md) - ç‰ˆæœ¬æ›´æ–°è®°å½•

### è¯¦ç»†æ–‡æ¡£
- [éœ€æ±‚æ–‡æ¡£](docs/01-éœ€æ±‚æ–‡æ¡£/) - åŠŸèƒ½éœ€æ±‚è¯´æ˜
- [æŠ€æœ¯è®¾è®¡](docs/02-æŠ€æœ¯è®¾è®¡/) - æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡
- [éƒ¨ç½²è®°å½•](docs/09-éƒ¨ç½²è®°å½•/) - éƒ¨ç½²è¿‡ç¨‹è®°å½•
- [æ“ä½œæŒ‡å—](docs/10-æ“ä½œæŒ‡å—/) - ä½¿ç”¨è¯´æ˜

## ğŸ”§ éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### ç®¡ç†åå°éƒ¨ç½²
```bash
./scripts/deploy/deploy-admin-complete.sh
```

#### åç«¯æœåŠ¡éƒ¨ç½²
```bash
./scripts/deploy/deploy-backend-complete.sh
```

#### SSLè¯ä¹¦éƒ¨ç½²
```bash
./scripts/deploy/deploy-ssl-cert.sh
```

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒï¼š[éƒ¨ç½²æ–‡æ¡£](docs/09-éƒ¨ç½²è®°å½•/)

## ğŸ“Š å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆï¼ˆ80%ï¼‰
- âœ… ç®¡ç†åå°éƒ¨ç½²ä¸Šçº¿
- âœ… åç«¯APIå®Œæ•´å¼€å‘
- âœ… HTTPSè¯ä¹¦é…ç½®
- âœ… æ•°æ®åº“ç»“æ„è®¾è®¡
- âœ… å¾®ä¿¡å°ç¨‹åºå¼€å‘

### â° ç­‰å¾…ä¸­ï¼ˆ15%ï¼‰
- â° ICPå¤‡æ¡ˆå®¡æ ¸ï¼ˆguandongfang.cnï¼‰
- â° å¾®ä¿¡å•†æˆ·å·å®¡æ ¸

### ğŸ”œ å¾…å¼€å‘ï¼ˆ5%ï¼‰
- ğŸ”œ å¾®ä¿¡æ”¯ä»˜æ¥å£å¯¹æ¥
- ğŸ”œ äºŒç»´ç ç”ŸæˆåŠŸèƒ½
- ğŸ”œ å°ç¨‹åºçœŸæœºæµ‹è¯•

## ğŸ” å®‰å…¨

### æ•æ„Ÿä¿¡æ¯
- SSHå¯†é’¥: `weixinpay.pem` (ä¸æäº¤åˆ°git)
- æ•°æ®åº“å¯†ç : `.env` æ–‡ä»¶
- å¾®ä¿¡APIå¯†é’¥: ç¯å¢ƒå˜é‡

### å®‰å…¨æ£€æŸ¥æ¸…å•
- [x] HTTPSå¼ºåˆ¶é‡å®šå‘
- [x] SSLè¯ä¹¦é…ç½®
- [x] æ•°æ®åº“è®¿é—®æ§åˆ¶
- [x] APIæ¥å£é‰´æƒ
- [x] æ•æ„Ÿæ–‡ä»¶ .gitignore

## ğŸ¤ è´¡çŒ®

### å¼€å‘è§„èŒƒ
1. **å»¶ç»­ç°æœ‰åŠŸèƒ½** - åªåœ¨ç°æœ‰åŸºç¡€ä¸Šæ‰©å±•
2. **ä¿®æ”¹å‰å…ˆå¤‡ä»½** - git commit ä¿å­˜å½“å‰çŠ¶æ€
3. **æµ‹è¯•åå†éƒ¨ç½²** - æœ¬åœ°æµ‹è¯•é€šè¿‡åå†ä¸Šä¼ 
4. **æ›´æ–°æ–‡æ¡£** - æ‰€æœ‰å˜æ›´å¿…é¡»æ›´æ–°æ–‡æ¡£

### ç¦æ­¢è¡Œä¸º
- âŒ ä¸è¦ä¿®æ”¹ç”Ÿäº§ç¯å¢ƒåç«¯ `payment-points-api-enhanced.js`
- âŒ ä¸è¦ä½¿ç”¨TypeScriptåç«¯ `backend/src/` (æœ‰ç¼–è¯‘é”™è¯¯)
- âŒ ä¸è¦é‡æ„å·²éƒ¨ç½²ä»£ç 
- âŒ ä¸è¦ä¿®æ”¹Nginxé…ç½® `nginx-guandongfang-fixed.conf`

è¯¦ç»†è§„åˆ™è¯·å‚è€ƒï¼š[.cursorrules](.cursorrules)

## ğŸ“ è”ç³»æ–¹å¼

- **æŠ€æœ¯æ”¯æŒ**: å‚è€ƒé¡¹ç›®æ–‡æ¡£
- **é—®é¢˜åé¦ˆ**: æäº¤ GitHub Issue
- **é¡¹ç›®ç»´æŠ¤**: å¼€å‘å›¢é˜Ÿ

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

**å½“å‰ç‰ˆæœ¬**: v2.0.0  
**æœ€åæ›´æ–°**: 2025-09-30  
**ç»´æŠ¤çŠ¶æ€**: âœ… ç§¯æç»´æŠ¤ä¸­
