# ç§¯åˆ†èµ é€å°ç¨‹åºé¡¹ç›®

## ğŸ¯ é¡¹ç›®ç®€ä»‹

åŸºäºå¾®ä¿¡æ”¯ä»˜çš„ç§¯åˆ†èµ é€ç³»ç»Ÿï¼Œç”¨æˆ·é€šè¿‡æ‰«ç æ”¯ä»˜åè‡ªåŠ¨è·å¾—1:1ç§¯åˆ†å¥–åŠ±ã€‚æœ¬é¡¹ç›®åŒ…å«å®Œæ•´çš„åç«¯APIæœåŠ¡å’Œå¾®ä¿¡å°ç¨‹åºå‰ç«¯ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- âœ… å¾®ä¿¡ç™»å½•æˆæƒ
- âœ… æ‰«ç æ”¯ä»˜åŠŸèƒ½
- âœ… æ”¯ä»˜æˆåŠŸå1:1ç§¯åˆ†å‘æ”¾
- âœ… ç§¯åˆ†ä½™é¢æŸ¥è¯¢
- âœ… ç§¯åˆ†è®°å½•ç®¡ç†
- ğŸš§ ç§¯åˆ†å•†åŸï¼ˆç¬¬äºŒæœŸå¼€å‘ï¼‰

## ğŸ— é¡¹ç›®ç»“æ„

```
weinxinzhifu/
â”œâ”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ 00-é¡¹ç›®å¼€å‘æ€»ä½“è§„åˆ’.md
â”‚   â”œâ”€â”€ 01-éœ€æ±‚æ–‡æ¡£/
â”‚   â”œâ”€â”€ 02-æŠ€æœ¯è®¾è®¡/
â”‚   â”œâ”€â”€ 03-äº§å“è®¾è®¡/
â”‚   â”œâ”€â”€ 04-å¼€å‘è§„èŒƒ/
â”‚   â”œâ”€â”€ 05-æµ‹è¯•æ–‡æ¡£/
â”‚   â””â”€â”€ 06-éƒ¨ç½²è¿ç»´/
â”œâ”€â”€ backend/                        # åç«¯APIæœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ controllers/            # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ middleware/             # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ routes/                 # è·¯ç”±
â”‚   â”‚   â””â”€â”€ app.ts                  # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ sql/                        # æ•°æ®åº“è„šæœ¬
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â””â”€â”€ frontend/                       # å‰ç«¯å°ç¨‹åº
    â””â”€â”€ miniprogram/
        â”œâ”€â”€ pages/                  # é¡µé¢
        â”œâ”€â”€ components/             # ç»„ä»¶
        â”œâ”€â”€ services/               # æœåŠ¡
        â”œâ”€â”€ utils/                  # å·¥å…·
        â”œâ”€â”€ app.js                  # åº”ç”¨å…¥å£
        â”œâ”€â”€ app.json                # åº”ç”¨é…ç½®
        â””â”€â”€ app.wxss                # å…¨å±€æ ·å¼
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18.0.0
- MySQL >= 8.0
- Redis >= 6.0
- å¾®ä¿¡å¼€å‘è€…å·¥å…·

### åç«¯æœåŠ¡éƒ¨ç½²

1. **å®‰è£…ä¾èµ–**
```bash
cd backend
npm install
```

2. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å®é™…é…ç½®
```

3. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
mysql -u root -p < sql/init.sql
```

4. **å¯åŠ¨å¼€å‘æœåŠ¡**
```bash
npm run dev
```

5. **æ„å»ºç”Ÿäº§ç‰ˆæœ¬**
```bash
npm run build
npm start
```

### å°ç¨‹åºéƒ¨ç½²

1. **å¯¼å…¥é¡¹ç›®**
   - æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
   - é€‰æ‹©"å¯¼å…¥é¡¹ç›®"
   - é¡¹ç›®ç›®å½•ï¼š`frontend/miniprogram`
   - AppIDï¼šå¡«å…¥ä½ çš„å°ç¨‹åºAppID

2. **é…ç½®åç«¯åœ°å€**
   - ä¿®æ”¹ `app.js` ä¸­çš„ `baseUrl`
   - åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®æœåŠ¡å™¨åŸŸå

3. **é¢„è§ˆè°ƒè¯•**
   - ç‚¹å‡»"é¢„è§ˆ"ç”ŸæˆäºŒç»´ç 
   - ä½¿ç”¨å¾®ä¿¡æ‰«ç åœ¨çœŸæœºé¢„è§ˆ

4. **ä¸Šä¼ å‘å¸ƒ**
   - ç‚¹å‡»"ä¸Šä¼ "æäº¤ä»£ç 
   - åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æäº¤å®¡æ ¸

## ğŸ”§ å¼€å‘æŒ‡å—

### åç«¯APIæ–‡æ¡£

#### è®¤è¯æ¥å£
- `POST /api/v1/auth/wechat-login` - å¾®ä¿¡ç™»å½•
- `GET /api/v1/auth/user-info` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /api/v1/auth/user-info` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

#### æ”¯ä»˜æ¥å£
- `POST /api/v1/payments` - åˆ›å»ºæ”¯ä»˜è®¢å•
- `GET /api/v1/payments/:orderId` - æŸ¥è¯¢è®¢å•çŠ¶æ€
- `POST /api/v1/payments/callback` - æ”¯ä»˜å›è°ƒ
- `GET /api/v1/payments/history` - æ”¯ä»˜å†å²

#### ç§¯åˆ†æ¥å£
- `GET /api/v1/points/balance` - è·å–ç§¯åˆ†ä½™é¢
- `GET /api/v1/points/history` - è·å–ç§¯åˆ†è®°å½•
- `GET /api/v1/points/statistics` - è·å–ç§¯åˆ†ç»Ÿè®¡

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **æ”¯ä»˜-ç§¯åˆ†åŒæ­¥**ï¼šä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
2. **ç”¨æˆ·ä½“éªŒä¼˜å…ˆ**ï¼šæ”¯ä»˜é¡µé¢1-3ç§’å†…æ˜ç¡®ç§¯åˆ†ä»·å€¼
3. **å®‰å…¨ç¬¬ä¸€**ï¼šæ‰€æœ‰æ¥å£HTTPSï¼Œæ•æ„Ÿæ•°æ®åŠ å¯†
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šä»£ç åˆ†åŒ…ã€ç¼“å­˜ç­–ç•¥ã€CDNåŠ é€Ÿ

## ğŸ“Š æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯æ ˆ
- **è¯­è¨€**ï¼šTypeScript
- **æ¡†æ¶**ï¼šExpress.js
- **æ•°æ®åº“**ï¼šMySQL 8.0
- **ç¼“å­˜**ï¼šRedis 6.0
- **è®¤è¯**ï¼šJWT
- **æ”¯ä»˜**ï¼šå¾®ä¿¡æ”¯ä»˜API

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šå¾®ä¿¡åŸç”Ÿå°ç¨‹åº
- **çŠ¶æ€ç®¡ç†**ï¼šZustand
- **ç½‘ç»œè¯·æ±‚**ï¼šwx.requestå°è£…
- **ä»£ç å‹ç¼©**ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·

## ğŸ”’ å®‰å…¨é…ç½®

### å¿…éœ€çš„å®‰å…¨æªæ–½
1. **HTTPSéƒ¨ç½²**ï¼šæ‰€æœ‰æ¥å£å¿…é¡»ä½¿ç”¨HTTPS
2. **æ•°æ®åŠ å¯†**ï¼šæ•æ„Ÿæ•°æ®ä¼ è¾“å’Œå­˜å‚¨åŠ å¯†
3. **ç­¾åéªŒè¯**ï¼šå¾®ä¿¡æ”¯ä»˜å›è°ƒç­¾åéªŒè¯
4. **æƒé™æ§åˆ¶**ï¼šç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
5. **è¾“å…¥éªŒè¯**ï¼šæ‰€æœ‰è¾“å…¥å‚æ•°ä¸¥æ ¼éªŒè¯

### é…ç½®æ£€æŸ¥æ¸…å•
- [ ] SSLè¯ä¹¦é…ç½®æ­£ç¡®
- [ ] å¾®ä¿¡æ”¯ä»˜åŸŸåç™½åå•
- [ ] APIå¯†é’¥å®‰å…¨å­˜å‚¨
- [ ] æ•°æ®åº“è®¿é—®æƒé™æœ€å°åŒ–
- [ ] æ—¥å¿—è„±æ•å¤„ç†

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# åç«¯æµ‹è¯•
cd backend
npm test                    # è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:watch         # ç›‘å¬æ¨¡å¼
npm run test:coverage      # è¦†ç›–ç‡æµ‹è¯•

# ä»£ç æ£€æŸ¥
npm run lint               # ESLintæ£€æŸ¥
npm run lint:fix           # è‡ªåŠ¨ä¿®å¤
```

### æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼šâ‰¥80%
- é›†æˆæµ‹è¯•è¦†ç›–ç‡ï¼šâ‰¥70%
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼š100%

## ğŸ“ˆ ç›‘æ§

### å…³é”®æŒ‡æ ‡
- **ä¸šåŠ¡æŒ‡æ ‡**ï¼šæ”¯ä»˜æˆåŠŸç‡ã€ç§¯åˆ†å‘æ”¾å‡†ç¡®ç‡
- **æ€§èƒ½æŒ‡æ ‡**ï¼šæ¥å£å“åº”æ—¶é—´ã€ç³»ç»Ÿå¯ç”¨æ€§
- **ç”¨æˆ·æŒ‡æ ‡**ï¼šæ—¥æ´»ç”¨æˆ·ã€æ”¯ä»˜è½¬åŒ–ç‡

### ç›‘æ§å·¥å…·
- **åº”ç”¨ç›‘æ§**ï¼šPrometheus + Grafana
- **æ—¥å¿—ç›‘æ§**ï¼šELK Stack
- **é”™è¯¯ç›‘æ§**ï¼šSentry

## ğŸš€ éƒ¨ç½²

### å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨åç«¯å¼€å‘æœåŠ¡
cd backend && npm run dev

# å¯åŠ¨å°ç¨‹åºå¼€å‘
# ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€ frontend/miniprogram
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# åç«¯éƒ¨ç½²
cd backend
npm run build
npm start

# å°ç¨‹åºå‘å¸ƒ
# åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ä¸Šä¼ ä»£ç 
# åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æäº¤å®¡æ ¸
```

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·å‚è€ƒï¼š`docs/06-éƒ¨ç½²è¿ç»´/01-éƒ¨ç½²æ–¹æ¡ˆæ–‡æ¡£.md`

## ğŸ“ è”ç³»æˆ‘ä»¬

- **æŠ€æœ¯æ”¯æŒ**ï¼štech-support@example.com
- **å®¢æœç”µè¯**ï¼š400-123-4567
- **é—®é¢˜åé¦ˆ**ï¼šè¯·æäº¤issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

---

**å¼€å‘å›¢é˜Ÿ**ï¼šç§¯åˆ†ç³»ç»Ÿå¼€å‘ç»„  
**ç‰ˆæœ¬**ï¼šv1.0.0  
**æœ€åæ›´æ–°**ï¼š2024å¹´12æœˆ
