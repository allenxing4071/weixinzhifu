# 03-用户故事和用例文档

## 📖 文档信息
- **文档版本**：V1.0
- **创建日期**：2024年9月
- **产品经理**：[姓名]
- **需求分析师**：[姓名]
- **评审状态**：待评审

---

## 🎯 文档概述

本文档通过用户故事的形式描述积分赠送小程序的功能需求，从用户角度出发，明确各个功能的使用场景、操作流程和期望结果。

### 用户故事编写原则
1. **用户角色明确**：清晰定义故事的主角
2. **需求具体**：描述具体的功能需求
3. **价值导向**：明确用户获得的价值
4. **可测试**：每个故事都有明确的验收标准

---

## 👥 用户角色定义

### 主要用户角色

#### 终端消费用户（Customer）
- **角色描述**：使用小程序进行支付的普通消费者
- **使用场景**：餐厅用餐、商店购物、服务消费
- **核心诉求**：支付便捷、获得优惠、积分有价值

#### 商户经营者（Merchant）
- **角色描述**：提供商品或服务的店铺经营者
- **使用场景**：日常收款、客户管理、营销推广
- **核心诉求**：收款安全、客户留存、增加收入

#### 平台管理员（Admin）
- **角色描述**：系统运营和管理人员
- **使用场景**：系统配置、数据监控、问题处理
- **核心诉求**：系统稳定、数据准确、运营高效

---

## 📱 用户故事集合

### Epic 1：用户注册和登录

#### US-001：微信快速注册
**作为** 一个新用户  
**我希望** 通过微信授权快速注册账户  
**以便于** 我能立即开始使用积分功能

**验收标准**：
- [ ] 点击授权按钮后能获取微信用户信息
- [ ] 首次授权自动创建用户账户
- [ ] 注册成功后自动登录系统
- [ ] 注册过程不超过30秒

**业务规则**：
- 微信授权失败时显示重试选项
- 用户可以选择是否提供手机号
- 必须同意用户协议才能完成注册

#### US-002：免密码登录
**作为** 一个已注册用户  
**我希望** 每次打开小程序时自动登录  
**以便于** 我不需要重复输入账号密码

**验收标准**：
- [ ] 7天内免登录（除非主动退出）
- [ ] 登录状态在小程序生命周期内保持
- [ ] 登录失效时自动跳转授权页面
- [ ] 多设备登录状态同步

### Epic 2：扫码支付功能

#### US-003：扫码识别商户
**作为** 一个消费用户  
**我希望** 扫描商户二维码时能快速识别商户信息  
**以便于** 我确认在正确的商户消费

**验收标准**：
- [ ] 扫码响应时间小于2秒
- [ ] 显示商户名称、头像、认证状态
- [ ] 显示商户营业状态（营业中/休息中）
- [ ] 识别失败时提供手动输入选项

**用户场景**：
```
场景：用户在餐厅用餐后准备支付
给定：用户已完成用餐，服务员提供二维码
当：用户打开小程序扫描二维码
那么：系统显示餐厅信息和支付选项
```

#### US-004：确认支付金额
**作为** 一个消费用户  
**我希望** 在支付前能清楚看到支付金额和积分奖励  
**以便于** 我能确认交易信息无误

**验收标准**：
- [ ] 支付金额用大字号显示
- [ ] 预计获得积分数量醒目展示
- [ ] 显示积分价值说明（1积分=1元）
- [ ] 提供支付确认和取消选项

#### US-005：微信支付体验
**作为** 一个消费用户  
**我希望** 支付过程简单快速  
**以便于** 我能快速完成交易

**验收标准**：
- [ ] 一键调用微信支付
- [ ] 支付过程中显示进度提示
- [ ] 支付成功立即显示结果
- [ ] 支付失败提供重试选项

**交互流程**：
```
用户操作流程：
1. 确认支付信息 → 点击"确认支付"
2. 自动跳转微信支付 → 完成支付验证
3. 支付成功 → 返回小程序
4. 查看支付结果 → 积分到账提示
```

#### US-006：积分到账确认
**作为** 一个消费用户  
**我希望** 支付成功后立即看到积分到账  
**以便于** 我能确认获得了应有的奖励

**验收标准**：
- [ ] 支付成功页面显示获得积分数量
- [ ] 积分到账有动画效果增强体验
- [ ] 显示积分余额更新
- [ ] 提供查看积分详情的入口

### Epic 3：积分查询和管理

#### US-007：积分余额查询
**作为** 一个消费用户  
**我希望** 随时查看我的积分余额  
**以便于** 我了解自己的积分财富

**验收标准**：
- [ ] 首页显示当前积分余额
- [ ] 支持下拉刷新更新余额
- [ ] 显示积分等价金额
- [ ] 显示积分有效期提醒

#### US-008：积分明细查询
**作为** 一个消费用户  
**我希望** 查看积分的获得和使用明细  
**以便于** 我了解积分的来源和去向

**验收标准**：
- [ ] 按时间顺序显示积分变动记录
- [ ] 区分积分获得和使用类型
- [ ] 显示每笔积分对应的商户和金额
- [ ] 支持按时间和类型筛选

**界面布局**：
```
积分明细页面：
├── 筛选条件（时间范围、类型）
├── 积分记录列表
│   ├── 时间戳
│   ├── 积分变动（+/-）
│   ├── 余额变化
│   ├── 来源说明
│   └── 关联订单
└── 分页加载
```

#### US-009：积分使用预览
**作为** 一个消费用户  
**我希望** 了解积分可以用来做什么  
**以便于** 我有动力积累更多积分

**验收标准**：
- [ ] 显示积分商城入口（为未来功能预留）
- [ ] 展示积分使用规则和价值
- [ ] 显示积分兑换示例
- [ ] 提供积分使用指南

### Epic 4：商户端功能

#### US-010：商户登录管理
**作为** 一个商户经营者  
**我希望** 能安全登录商户管理后台  
**以便于** 我能管理收款和查看数据

**验收标准**：
- [ ] 支持账号密码和手机验证码登录
- [ ] 登录状态保持24小时
- [ ] 异地登录安全提醒
- [ ] 登录日志记录

#### US-011：生成收款码
**作为** 一个商户经营者  
**我希望** 能生成专属的收款二维码  
**以便于** 客户扫码支付并获得积分

**验收标准**：
- [ ] 支持固定金额和自定义金额两种类型
- [ ] 可自定义二维码样式（商户名称、Logo）
- [ ] 生成的二维码支持打印
- [ ] 可以管理多个收款码

**功能场景**：
```
场景1：餐厅创建菜品收款码
给定：商户登录管理后台
当：选择"固定金额"创建收款码
并且：设置金额为38元，商品名称为"招牌汤面"
那么：生成带有商户信息的二维码
并且：客户扫码后看到"招牌汤面 38元"

场景2：零售店创建通用收款码
给定：商户登录管理后台
当：选择"自定义金额"创建收款码
那么：生成通用收款码
并且：客户扫码后可以输入任意金额
```

#### US-012：交易流水查询
**作为** 一个商户经营者  
**我希望** 查看我的收款记录和客户积分发放情况  
**以便于** 我了解经营状况和积分营销效果

**验收标准**：
- [ ] 按日期查询交易记录
- [ ] 显示交易金额、积分发放、客户信息
- [ ] 提供交易统计数据（日/周/月）
- [ ] 支持导出交易数据

#### US-013：客户积分查询
**作为** 一个商户经营者  
**我希望** 能查询在我店消费的客户积分情况  
**以便于** 我能为老客户提供更好的服务

**验收标准**：
- [ ] 显示客户在本店的消费次数
- [ ] 显示客户通过本店获得的积分
- [ ] 客户消费频次和金额统计
- [ ] 客户等级标识（新客户/老客户）

### Epic 5：系统管理功能

#### US-014：数据统计查看
**作为** 一个平台管理员  
**我希望** 查看系统整体运营数据  
**以便于** 我能监控平台健康度和业务增长

**验收标准**：
- [ ] 显示用户注册和活跃数据
- [ ] 显示交易金额和笔数统计
- [ ] 显示积分发放和使用数据
- [ ] 提供数据可视化图表

#### US-015：商户管理
**作为** 一个平台管理员  
**我希望** 管理平台上的商户信息和状态  
**以便于** 我能确保平台商户质量

**验收标准**：
- [ ] 审核商户注册申请
- [ ] 管理商户状态（启用/禁用）
- [ ] 查看商户经营数据
- [ ] 处理商户相关问题

---

## 🧪 用例测试场景

### 核心用例测试

#### 测试用例1：首次用户完整支付流程
```
测试场景：新用户首次使用小程序支付
前置条件：用户从未使用过该小程序

测试步骤：
1. 用户扫描商户二维码
2. 系统提示授权登录
3. 用户点击微信授权
4. 系统获取用户信息并自动注册
5. 显示支付确认页面
6. 用户确认支付信息
7. 调用微信支付完成支付
8. 显示支付成功和积分到账

预期结果：
- 整个流程顺畅完成
- 积分正确发放到用户账户
- 用户能查看到积分余额

风险点：
- 微信授权可能失败
- 支付过程可能被中断
- 积分发放可能延迟
```

#### 测试用例2：老用户快速支付
```
测试场景：已注册用户日常支付
前置条件：用户已完成注册并有历史支付记录

测试步骤：
1. 用户打开小程序（自动登录）
2. 扫描商户二维码
3. 直接显示支付确认页面
4. 用户确认支付
5. 完成支付获得积分

预期结果：
- 免登录直接进入支付流程
- 支付体验更加流畅
- 积分累计到现有余额

性能要求：
- 扫码到支付确认 < 3秒
- 支付成功到积分到账 < 5秒
```

#### 测试用例3：支付异常处理
```
测试场景：支付过程中出现异常
前置条件：用户正常扫码进入支付流程

异常情况1：网络中断
- 支付过程中网络断开
- 系统显示网络错误提示
- 提供重试和返回选项

异常情况2：支付超时
- 用户在微信支付页面停留超过5分钟
- 系统自动取消订单
- 提示用户重新发起支付

异常情况3：重复支付
- 用户连续多次点击支付按钮
- 系统防止重复扣款
- 只创建一个有效订单

预期结果：
- 所有异常都有友好提示
- 不会出现资金损失
- 用户能够正常重试
```

---

## 📊 用户故事优先级

### 高优先级（Must Have）
- US-001：微信快速注册
- US-003：扫码识别商户
- US-004：确认支付金额
- US-005：微信支付体验
- US-006：积分到账确认
- US-011：生成收款码

### 中优先级（Should Have）
- US-002：免密码登录
- US-007：积分余额查询
- US-008：积分明细查询
- US-010：商户登录管理
- US-012：交易流水查询

### 低优先级（Could Have）
- US-009：积分使用预览
- US-013：客户积分查询
- US-014：数据统计查看
- US-015：商户管理

### 未来版本（Won't Have This Time）
- 积分商城功能
- 积分转赠功能
- 社交分享功能
- 营销活动管理

---

## ✅ 验收标准汇总

### 功能完整性验收
- [ ] 所有高优先级用户故事100%实现
- [ ] 所有中优先级用户故事≥90%实现
- [ ] 关键用户路径畅通无阻

### 用户体验验收
- [ ] 用户满意度评分≥4.5分（5分制）
- [ ] 首次使用成功率≥90%
- [ ] 支付完成率≥95%

### 性能验收
- [ ] 扫码识别响应时间≤2秒
- [ ] 支付确认页面加载时间≤1秒
- [ ] 积分到账时间≤3秒

### 稳定性验收
- [ ] 系统可用性≥99.9%
- [ ] 支付成功率≥99.5%
- [ ] 积分发放准确率100%

---

## 📝 故事地图

### 用户旅程映射
```
发现阶段 → 首次使用 → 日常使用 → 深度使用
    ↓         ↓         ↓         ↓
了解产品   扫码支付    快速支付   积分管理
注册登录   获得积分    查看余额   数据分析
         确认价值    积分明细   客户服务
```

### 版本发布规划
```
V1.0（MVP版本）：
├── 用户注册登录
├── 扫码支付功能
├── 积分发放查询
└── 商户收款码

V1.1（优化版本）：
├── 用户体验优化
├── 性能提升
├── 数据统计
└── 商户管理增强

V2.0（增强版本）：
├── 积分商城
├── 营销工具
├── 社交功能
└── 智能推荐
```

---

**文档状态**：待产品评审  
**下一步行动**：用例测试计划制定  
**责任人**：产品经理  
**评审时间**：待定
