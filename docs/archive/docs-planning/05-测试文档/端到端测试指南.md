# 🧪 积分系统端到端测试指南

## 📊 系统概览

我们已经成功整合了商户管理系统，现在需要进行完整的端到端测试。

### ✅ 已完成的组件：

1. **统一商户管理后台** (http://8.156.84.226/admin/merchants)
   - 显示真实的微信商户信息
   - 支持单个/批量二维码生成
   - 统计面板显示商户状态

2. **微信小程序** (已配置生产环境)
   - API地址: https://8.156.84.226/api/v1/
   - 扫码支付页面
   - 积分查询功能

3. **后端API服务**
   - 统一商户管理API
   - 二维码生成服务
   - 微信支付集成

## 🔄 完整测试流程

### 步骤1: 管理后台生成二维码
1. 访问: http://8.156.84.226/admin/merchants
2. 登录: admin / admin123
3. 选择一个商户(如: 仁寿县怀仁省道云创汇会所)
4. 点击"生成二维码"按钮
5. 确认二维码生成成功并可下载

### 步骤2: 微信小程序扫码测试
1. 在微信开发者工具中打开小程序
2. 使用手机微信扫描生成的二维码
3. 确认跳转到支付页面
4. 验证商户信息显示正确

### 步骤3: 支付流程测试
1. 在小程序中输入支付金额
2. 点击支付按钮
3. 模拟支付成功
4. 确认积分正确发放

### 步骤4: 积分系统验证
1. 查看用户积分余额
2. 验证积分记录
3. 确认商户收款记录

## 🏪 当前商户信息

基于您的微信支付后台，我们有以下5个真实商户：

| 商户号 | 商户名称 | 申请单号 | 状态 |
|--------|----------|----------|------|
| 1728001633 | 仁寿县怀仁省道云创汇会所（个体工商户） | 20000026911156098 | 已完成 |
| 1727952181 | 仁寿县怀仁镇府商店（个体工商户） | 20000026908589917 | 已完成 |
| 1727857063 | 仁寿县怀仁省道商旅游所生（个体工商户） | 20000026906234402 | 已完成 |
| 1727774152 | 成都市青羊区商旅业贸易有限公司 | 20000026901164951 | 已完成 |
| 1727656030 | 德阳市金堂科技有限公司 | 20000026893722474 | 已完成 |

## 📱 微信配置信息

- **AppID**: wx9bed12ef0904d035
- **AppSecret**: d0169fe1d4b9441e7b180d814e868553
- **服务商商户号**: 1727765161
- **微信访问令牌**: ✅ 可正常获取

## 🔧 技术要点

### 二维码生成
- 优先使用微信小程序码
- 备用方案使用标准二维码
- 包含商户ID和金额信息

### 小程序集成
- 扫码自动解析商户信息
- 跳转到支付页面
- 支持金额调整

### 积分发放规则
- 1元 = 1积分
- 支付成功后立即发放
- 支持积分查询和历史记录

## 🎯 下一步行动

1. **立即测试**: 按照上述流程进行完整测试
2. **问题修复**: 发现问题立即修复
3. **功能优化**: 基于测试结果优化用户体验
4. **提交审核**: 确认无误后提交微信小程序审核

## 📞 支持联系

如在测试过程中遇到问题，请提供：
- 具体操作步骤
- 错误信息截图
- 浏览器控制台日志
- 手机端小程序表现

