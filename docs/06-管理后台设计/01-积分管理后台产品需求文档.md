# 积分管理后台产品需求文档（PRD）

## 📖 文档信息
- **文档版本**：V1.0
- **创建日期**：2024年9月
- **产品经理**：产品开发团队
- **评审状态**：待评审
- **预计上线时间**：2025年9月

---

## 🎯 产品概述

### 产品背景
基于已有的微信支付积分赠送系统，为平台运营人员、商户管理员提供完整的Web管理后台，实现积分系统的全面管控、数据分析和业务运营。

### 产品目标
1. **运营目标**：提供数据驱动的运营决策支持
2. **管理目标**：实现商户、用户、积分的统一管理
3. **监控目标**：实时监控系统运行状态和业务指标
4. **分析目标**：提供深度的业务数据分析和报表

### 产品定位
企业级积分营销系统的管理控制中心，面向B端用户的专业管理工具。

---

## 👥 目标用户分析

### 1. 平台超级管理员
- **角色权限**：系统最高权限，全局管理
- **主要职责**：
  - 商户审核和管理
  - 系统配置和参数设置
  - 数据统计和分析
  - 风控规则制定
  - 财务数据管理

### 2. 运营管理员
- **角色权限**：业务运营权限
- **主要职责**：
  - 积分活动策划和执行
  - 用户数据分析
  - 营销活动管理
  - 客服问题处理
  - 运营数据报表

### 3. 商户管理员
- **角色权限**：商户自身数据权限
- **主要职责**：
  - 查看自己的交易数据
  - 积分发放统计
  - 客户信息查看
  - 收款二维码管理
  - 营销活动参与

### 4. 财务管理员
- **角色权限**：财务数据权限
- **主要职责**：
  - 资金流水查询
  - 积分成本统计
  - 财务报表生成
  - 结算数据管理

---

## 🔧 功能需求

### 1. 用户认证和权限管理

#### 1.1 登录系统
**功能描述**：管理员通过账号密码登录系统

**详细需求**：
- [ ] 账号密码登录
- [ ] 手机验证码登录
- [ ] 双因子认证（可选）
- [ ] 记住登录状态
- [ ] 登录日志记录
- [ ] 异地登录提醒

**安全要求**：
- 密码强度验证（最少8位，包含数字字母）
- 登录失败锁定机制（5次失败锁定30分钟）
- Session超时管理（2小时无操作自动退出）
- IP白名单支持

#### 1.2 权限管理
**功能描述**：基于角色的权限控制系统

**详细需求**：
- [ ] 角色定义和管理
- [ ] 权限分配和回收
- [ ] 功能模块权限控制
- [ ] 数据访问权限控制
- [ ] 操作日志记录

### 2. 仪表板和数据概览

#### 2.1 运营数据仪表板
**功能描述**：实时展示核心业务指标

**详细需求**：
- [ ] 今日/本月关键指标卡片
  - 新增用户数
  - 支付订单数
  - 支付总金额
  - 积分发放总量
  - 积分使用总量
- [ ] 实时数据更新（5分钟刷新）
- [ ] 同比/环比增长率显示
- [ ] 异常数据预警提示

#### 2.2 图表分析
**功能描述**：多维度的数据可视化分析

**详细需求**：
- [ ] 支付趋势图（日/周/月）
- [ ] 积分发放趋势图
- [ ] 用户增长趋势图
- [ ] 商户交易排行榜
- [ ] 地域分布热力图
- [ ] 用户活跃度分析

### 3. 用户管理

#### 3.1 用户列表和查询
**功能描述**：用户信息的查询和管理

**详细需求**：
- [ ] 用户列表分页展示
- [ ] 多条件筛选查询
  - 注册时间范围
  - 积分余额范围
  - 用户状态（活跃/不活跃/禁用）
  - 最后活跃时间
- [ ] 用户信息详情查看
- [ ] 用户状态管理（启用/禁用/删除）
- [ ] 批量操作支持

#### 3.2 用户详情管理
**功能描述**：单个用户的详细信息管理

**详细需求**：
- [ ] 基本信息展示（昵称、头像、手机号）
- [ ] 积分账户信息
  - 当前余额
  - 累计获得积分
  - 累计消费积分
  - 即将过期积分
- [ ] 交易记录查询
- [ ] 积分变动记录
- [ ] 用户行为分析
- [ ] 手动调整积分（管理员操作）

### 4. 商户管理

#### 4.1 商户注册审核
**功能描述**：新商户注册的审核流程

**重要说明**：商户信息必须与微信支付合作伙伴平台字段完全匹配，才能生成有效的收款二维码。

**详细需求**：
- [ ] 商户注册申请列表
- [ ] 微信支付字段完整性检查
  - 申请单号(`applyment_id`)验证
  - 特约商户号(`sub_mch_id`)验证
  - 商户名称与营业执照一致性检查
- [ ] 商户资质审核
  - 营业执照验证
  - 身份证件验证
  - 银行账户验证
  - 微信支付审核状态同步
- [ ] 审核状态管理（待审核/通过/拒绝/微信审核中）
- [ ] 审核意见记录
- [ ] 审核流程跟踪
- [ ] 收款二维码生成资格检查

#### 4.2 商户信息管理
**功能描述**：已注册商户的信息管理

**详细需求**：
- [ ] 商户列表和筛选
- [ ] 商户基本信息编辑
- [ ] 商户状态管理（启用/禁用/暂停）
- [ ] 商户等级管理
- [ ] 商户标签管理
- [ ] 收款权限控制

#### 4.3 商户数据统计
**功能描述**：商户经营数据的统计分析

**详细需求**：
- [ ] 商户交易概览
  - 总交易金额
  - 总订单数
  - 平均客单价
  - 积分发放总量
- [ ] 交易趋势分析
- [ ] 客户构成分析
- [ ] 商户排行榜
- [ ] 收益分析报表

### 5. 积分系统管理

#### 5.1 积分规则配置
**功能描述**：积分系统规则的配置管理

**详细需求**：
- [ ] 积分兑换比例设置
- [ ] 积分有效期配置
- [ ] 积分上限设置
- [ ] 特殊活动积分倍数
- [ ] 积分过期提醒设置
- [ ] 积分冻结规则

#### 5.2 积分统计分析
**功能描述**：积分发放和使用的统计分析

**详细需求**：
- [ ] 积分发放统计
  - 日/周/月积分发放量
  - 按商户统计发放量
  - 按用户等级统计
- [ ] 积分使用统计
- [ ] 积分过期统计
- [ ] 积分成本分析
- [ ] ROI分析报表

#### 5.3 积分操作管理
**功能描述**：积分的手动调整和批量操作

**详细需求**：
- [ ] 批量积分发放
- [ ] 积分手动调整
- [ ] 积分冻结/解冻
- [ ] 异常积分处理
- [ ] 积分补发操作
- [ ] 操作审批流程

### 6. 支付订单管理

#### 6.1 订单查询和管理
**功能描述**：支付订单的查询和状态管理

**详细需求**：
- [ ] 订单列表和筛选
  - 订单状态筛选
  - 时间范围筛选
  - 金额范围筛选
  - 商户筛选
  - 支付方式筛选
- [ ] 订单详情查看
- [ ] 订单状态管理
- [ ] 异常订单处理
- [ ] 退款申请审核

#### 6.2 支付数据统计
**功能描述**：支付相关的数据统计分析

**详细需求**：
- [ ] 支付成功率统计
- [ ] 支付金额趋势
- [ ] 支付方式占比
- [ ] 支付时段分析
- [ ] 异常支付监控
- [ ] 支付渠道分析

### 7. 系统监控和日志

#### 7.1 系统监控
**功能描述**：系统运行状态的实时监控

**详细需求**：
- [ ] 服务器状态监控
  - CPU使用率
  - 内存使用率
  - 磁盘使用率
  - 网络状态
- [ ] 应用服务监控
  - API响应时间
  - 接口调用量
  - 错误率统计
  - 并发用户数
- [ ] 数据库监控
  - 数据库连接数
  - 查询性能
  - 存储使用情况

#### 7.2 操作日志管理
**功能描述**：系统操作的日志记录和查询

**详细需求**：
- [ ] 管理员操作日志
- [ ] 用户行为日志
- [ ] 系统异常日志
- [ ] 安全事件日志
- [ ] 日志查询和筛选
- [ ] 日志导出功能

### 8. 财务管理

#### 8.1 资金流水管理
**功能描述**：平台资金流水的管理和统计

**详细需求**：
- [ ] 支付流水查询
- [ ] 积分成本统计
- [ ] 商户结算管理
- [ ] 平台收益统计
- [ ] 财务报表生成
- [ ] 异常资金监控

#### 8.2 成本分析
**功能描述**：积分成本和ROI分析

**详细需求**：
- [ ] 积分发放成本统计
- [ ] 用户获客成本分析
- [ ] 活动ROI计算
- [ ] 成本趋势分析
- [ ] 预算管理功能

### 9. 营销活动管理

#### 9.1 活动策划和执行
**功能描述**：积分营销活动的策划和管理

**详细需求**：
- [ ] 营销活动创建
- [ ] 活动规则配置
- [ ] 活动时间管理
- [ ] 活动效果监控
- [ ] 活动数据分析
- [ ] 活动模板管理

#### 9.2 优惠券管理
**功能描述**：积分兑换优惠券的管理

**详细需求**：
- [ ] 优惠券创建和配置
- [ ] 优惠券发放管理
- [ ] 优惠券使用统计
- [ ] 优惠券核销记录
- [ ] 优惠券效果分析

### 10. 设置和配置

#### 10.1 系统配置
**功能描述**：系统参数和配置的管理

**详细需求**：
- [ ] 基础参数配置
- [ ] 微信支付配置
- [ ] 短信通知配置
- [ ] 邮件通知配置
- [ ] 系统维护模式
- [ ] 备份恢复设置

#### 10.2 数据备份管理
**功能描述**：系统数据的备份和恢复

**详细需求**：
- [ ] 自动备份配置
- [ ] 手动备份操作
- [ ] 备份文件管理
- [ ] 数据恢复功能
- [ ] 备份状态监控

---

## 🎨 UI/UX设计要求

### 整体设计原则
1. **专业简洁**：企业级管理后台的专业感
2. **数据可视化**：重要数据图表化展示
3. **操作便捷**：常用功能快速访问
4. **响应式设计**：支持不同屏幕尺寸

### 页面布局结构
```
┌─────────────────────────────────────────┐
│  Logo    |    导航菜单    |   用户信息   │
├─────────────────────────────────────────┤
│ 侧边栏菜单  │         主内容区域          │
│           │                           │
│  - 仪表板  │    ┌─────────────────┐     │
│  - 用户管理 │    │     页面内容    │     │
│  - 商户管理 │    │                 │     │
│  - 积分管理 │    │                 │     │
│  - 订单管理 │    └─────────────────┘     │
│  - 系统监控 │                           │
│  - 设置    │                           │
└─────────────────────────────────────────┘
```

### 核心页面设计

#### 1. 仪表板页面
- **顶部KPI卡片**：4-6个关键指标
- **图表区域**：2-3个核心趋势图
- **快速操作区**：常用管理功能入口
- **实时提醒**：异常数据和待处理事项

#### 2. 列表页面标准
- **搜索筛选区**：顶部搜索和筛选条件
- **操作按钮区**：批量操作和新增按钮
- **数据表格区**：支持排序、分页的数据表
- **操作列**：编辑、删除等操作按钮

#### 3. 详情页面标准
- **标签页结构**：基本信息、详细数据、操作记录
- **信息卡片**：重要信息突出显示
- **操作按钮**：页面底部或右上角
- **关联数据**：相关数据的快速跳转

### 交互设计要求
1. **加载状态**：所有异步操作显示加载状态
2. **操作反馈**：成功/失败操作的明确提示
3. **确认机制**：重要操作需要二次确认
4. **键盘导航**：支持键盘快捷操作
5. **数据导出**：重要数据支持Excel导出

---

## 📊 数据指标

### 性能指标
- **页面加载时间**：首屏加载 ≤ 3秒
- **接口响应时间**：数据查询 ≤ 500ms
- **数据刷新频率**：关键数据5分钟更新
- **并发支持**：支持50个管理员同时在线

### 易用性指标
- **学习成本**：新用户30分钟内上手
- **操作效率**：常用操作 ≤ 3步完成
- **错误率**：用户操作错误率 ≤ 5%
- **满意度**：管理员满意度 ≥ 4.5/5.0

### 安全指标
- **登录安全**：强制密码策略 + 登录限制
- **数据安全**：敏感数据脱敏显示
- **操作审计**：100%操作日志记录
- **权限控制**：细粒度权限验证

---

## 🚀 技术架构要求

### 前端技术栈
- **框架**：React 18 + TypeScript
- **UI组件库**：Ant Design Pro
- **状态管理**：Redux Toolkit + RTK Query
- **路由管理**：React Router v6
- **图表库**：Apache ECharts
- **构建工具**：Vite

### 后端技术栈
- **API框架**：基于现有Express.js扩展
- **认证方式**：JWT + Redis Session
- **权限控制**：RBAC模型
- **数据查询**：复用现有MySQL数据库
- **文件存储**：阿里云OSS

### 数据库设计
- **管理员表**：存储管理员账号信息
- **角色权限表**：RBAC权限模型
- **操作日志表**：记录所有管理操作
- **配置参数表**：系统配置信息

---

## 📅 开发计划

### 第一阶段：基础框架（2周）
- [ ] 登录认证系统
- [ ] 权限管理框架
- [ ] 基础页面布局
- [ ] 数据库设计

### 第二阶段：核心功能（4周）
- [ ] 仪表板开发
- [ ] 用户管理模块
- [ ] 商户管理模块
- [ ] 积分管理模块

### 第三阶段：高级功能（3周）
- [ ] 数据分析报表
- [ ] 系统监控
- [ ] 营销活动管理
- [ ] 财务管理

### 第四阶段：测试上线（1周）
- [ ] 功能测试
- [ ] 性能测试
- [ ] 安全测试
- [ ] 部署上线

---

## ⚠️ 风险评估

### 技术风险
- **数据量增长**：大量数据的查询性能优化
- **并发访问**：多管理员同时操作的并发控制
- **系统稳定性**：7×24小时稳定运行要求

### 业务风险
- **权限设计**：权限设计不当导致数据泄露
- **操作误区**：管理员误操作影响业务
- **数据准确性**：统计数据的准确性要求

### 应对策略
1. **技术保障**：分页查询、缓存优化、读写分离
2. **安全保障**：细粒度权限控制、操作审计
3. **培训支持**：完善的操作手册和培训
4. **监控告警**：关键操作和异常的实时告警

---

## 🎯 成功标准

### 功能完整性
- [ ] 所有PRD功能100%实现
- [ ] 关键业务流程端到端测试通过
- [ ] 性能指标达标

### 用户验收
- [ ] 超级管理员验收通过
- [ ] 运营管理员验收通过
- [ ] 商户管理员验收通过
- [ ] 用户培训完成

### 上线标准
- [ ] 安全测试通过
- [ ] 性能测试通过
- [ ] 备份恢复验证通过
- [ ] 监控告警配置完成

---

**文档状态**：待产品评审  
**下一步行动**：UI/UX设计启动  
**责任人**：产品经理  
**预计评审时间**：本周内
