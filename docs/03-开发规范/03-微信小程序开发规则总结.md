# 03-å¾®ä¿¡å°ç¨‹åºå¼€å‘è§„åˆ™æ€»ç»“

## ğŸ“– æ–‡æ¡£ä¿¡æ¯
- **æ–‡æ¡£ç‰ˆæœ¬**ï¼šV1.0
- **åˆ›å»ºæ—¥æœŸ**ï¼š2024å¹´12æœˆ
- **ç¼–å†™äºº**ï¼šæŠ€æœ¯å›¢é˜Ÿ
- **å®¡æ ¸äºº**ï¼š[å§“å]
- **æ›´æ–°è¯´æ˜**ï¼šåŸºäºæœ€æ–°å¾®ä¿¡å®˜æ–¹æ–‡æ¡£æ•´ç†

---

## ğŸ¯ æ ¸å¿ƒå¼€å‘è§„åˆ™æ¦‚è§ˆ

æœ¬æ–‡æ¡£æ±‡æ€»äº†å¾®ä¿¡å°ç¨‹åºå¼€å‘çš„æ ¸å¿ƒè§„åˆ™å’Œæœ€ä½³å®è·µï¼Œç¡®ä¿å¼€å‘è¿‡ç¨‹ç¬¦åˆå¾®ä¿¡å¹³å°è¦æ±‚ï¼Œæé«˜å®¡æ ¸é€šè¿‡ç‡ã€‚

### å…³é”®é™åˆ¶ä¸€è§ˆè¡¨
| é™åˆ¶é¡¹ | å…·ä½“è¦æ±‚ | å½±å“èŒƒå›´ | åº”å¯¹ç­–ç•¥ |
|--------|----------|----------|----------|
| ä»£ç åŒ…å¤§å° | ä¸»åŒ…â‰¤2MBï¼Œæ€»åŒ…â‰¤20MB | åŠŸèƒ½æ‹†åˆ† | åˆ†åŒ…åŠ è½½ã€ä»£ç å‹ç¼© |
| è¯·æ±‚å¹¶å‘ | åŒæ—¶â‰¤10ä¸ª | ç½‘ç»œè¯·æ±‚ | è¯·æ±‚é˜Ÿåˆ—ã€åˆå¹¶è¯·æ±‚ |
| æœ¬åœ°å­˜å‚¨ | å•keyâ‰¤1MBï¼Œæ€»é‡â‰¤10MB | æ•°æ®ç¼“å­˜ | å®šæœŸæ¸…ç†ã€äº‘ç«¯å­˜å‚¨ |
| æ–‡ä»¶ä¸Šä¼  | å•æ–‡ä»¶â‰¤10MB | å›¾ç‰‡è§†é¢‘ | å‹ç¼©ä¸Šä¼ ã€åˆ†ç‰‡ä¼ è¾“ |

---

## ğŸ“ æŠ€æœ¯è§„èŒƒè¯¦è§£

### 1. ä»£ç åŒ…ç®¡ç†è§„èŒƒ

#### ä»£ç åŒ…ç±»å‹å’Œé™åˆ¶
```javascript
// ä»£ç åŒ…ç»“æ„
const packageStructure = {
  mainPackage: {
    maxSize: '2MB',
    content: 'æ ¸å¿ƒåŠŸèƒ½ã€å¯åŠ¨é¡µé¢ã€å…¬å…±èµ„æº',
    required: true
  },
  subPackages: {
    maxSize: '2MB/ä¸ª',
    maxCount: 20,
    totalMaxSize: '20MB',
    lazyLoad: true
  }
}

// æœ€ä½³å®è·µ
const optimizationStrategies = {
  imageOptimization: {
    format: 'WebPä¼˜å…ˆ',
    maxSize: 'å•å¼ <200KB',
    lazyLoad: true,
    CDN: 'å¤§å›¾ä½¿ç”¨CDN'
  },
  codeOptimization: {
    treeShaking: true,
    minify: true,
    removeConsole: true,
    splitChunks: true
  }
}
```

#### åˆ†åŒ…é…ç½®ç¤ºä¾‹
```json
// app.json
{
  "pages": [
    "pages/index/index",
    "pages/login/login"
  ],
  "subpackages": [
    {
      "root": "packagePayment",
      "name": "payment",
      "pages": [
        "pages/confirm/index",
        "pages/result/index"
      ],
      "independent": false
    },
    {
      "root": "packagePoints",
      "name": "points",
      "pages": [
        "pages/balance/index",
        "pages/history/index"
      ]
    }
  ],
  "preloadRule": {
    "pages/index/index": {
      "network": "all",
      "packages": ["payment"]
    }
  }
}
```

### 2. ç½‘ç»œè¯·æ±‚è§„èŒƒ

#### è¯·æ±‚é™åˆ¶å’Œæœ€ä½³å®è·µ
```javascript
// ç½‘ç»œè¯·æ±‚é™åˆ¶
const networkLimits = {
  concurrent: 10,          // æœ€å¤§å¹¶å‘æ•°
  timeout: 60000,         // è¶…æ—¶æ—¶é—´(ms)
  maxUploadSize: '10MB',  // å•æ¬¡ä¸Šä¼ å¤§å°
  maxDownloadSize: '50MB' // å•æ¬¡ä¸‹è½½å¤§å°
}

// è¯·æ±‚å°è£…ç¤ºä¾‹
class RequestManager {
  constructor() {
    this.queue = []
    this.running = 0
    this.maxConcurrent = 10
  }
  
  async request(options) {
    // é˜Ÿåˆ—ç®¡ç†
    if (this.running >= this.maxConcurrent) {
      await this.waitForSlot()
    }
    
    this.running++
    
    try {
      // æ·»åŠ é€šç”¨é…ç½®
      const config = {
        ...options,
        header: {
          'content-type': 'application/json',
          'Authorization': `Bearer ${getToken()}`,
          ...options.header
        },
        timeout: 30000,
        dataType: 'json'
      }
      
      // å‘èµ·è¯·æ±‚
      const res = await wx.request(config)
      
      // ç»Ÿä¸€é”™è¯¯å¤„ç†
      if (res.statusCode !== 200) {
        throw new Error(`è¯·æ±‚å¤±è´¥: ${res.statusCode}`)
      }
      
      return res.data
      
    } finally {
      this.running--
      this.processQueue()
    }
  }
}
```

### 3. æ•°æ®å­˜å‚¨è§„èŒƒ

#### æœ¬åœ°å­˜å‚¨ç®¡ç†
```javascript
// å­˜å‚¨é™åˆ¶
const storageLimits = {
  singleKey: '1MB',
  totalSize: '10MB',
  keyLength: 1024  // keyæœ€å¤§é•¿åº¦
}

// å­˜å‚¨ç®¡ç†å™¨
class StorageManager {
  // å¸¦è¿‡æœŸæ—¶é—´çš„å­˜å‚¨
  static setWithExpiry(key, value, ttl) {
    const now = new Date()
    const item = {
      value: value,
      expiry: now.getTime() + ttl
    }
    wx.setStorageSync(key, JSON.stringify(item))
  }
  
  // è·å–å¹¶æ£€æŸ¥è¿‡æœŸ
  static getWithExpiry(key) {
    const itemStr = wx.getStorageSync(key)
    if (!itemStr) return null
    
    const item = JSON.parse(itemStr)
    const now = new Date()
    
    if (now.getTime() > item.expiry) {
      wx.removeStorageSync(key)
      return null
    }
    
    return item.value
  }
  
  // å­˜å‚¨ç©ºé—´ç®¡ç†
  static async checkStorageSize() {
    const info = await wx.getStorageInfo()
    const usage = info.currentSize / info.limitSize
    
    if (usage > 0.8) {
      // æ¸…ç†è¿‡æœŸæ•°æ®
      this.cleanExpiredData()
    }
    
    return {
      used: info.currentSize,
      limit: info.limitSize,
      usage: `${(usage * 100).toFixed(2)}%`
    }
  }
}
```

### 4. æ”¯ä»˜æ¥å£è§„èŒƒ

#### å¾®ä¿¡æ”¯ä»˜æµç¨‹
```javascript
// æ”¯ä»˜å‚æ•°ç»“æ„
interface PaymentParams {
  // ç»Ÿä¸€ä¸‹å•å‚æ•°
  unifiedOrder: {
    appid: string         // å°ç¨‹åºID
    mch_id: string        // å•†æˆ·å·
    nonce_str: string     // éšæœºå­—ç¬¦ä¸²
    sign: string          // ç­¾å
    body: string          // å•†å“æè¿°
    out_trade_no: string  // å•†æˆ·è®¢å•å·
    total_fee: number     // æ€»é‡‘é¢(åˆ†)
    spbill_create_ip: string // ç»ˆç«¯IP
    notify_url: string    // é€šçŸ¥åœ°å€
    trade_type: 'JSAPI'   // äº¤æ˜“ç±»å‹
    openid: string        // ç”¨æˆ·openid
  }
  
  // å°ç¨‹åºè°ƒèµ·æ”¯ä»˜å‚æ•°
  requestPayment: {
    timeStamp: string     // æ—¶é—´æˆ³
    nonceStr: string      // éšæœºä¸²
    package: string       // ç»Ÿä¸€ä¸‹å•æ¥å£è¿”å›çš„ prepay_id å‚æ•°å€¼
    signType: 'MD5' | 'HMAC-SHA256'
    paySign: string       // ç­¾å
  }
}

// æ”¯ä»˜å®ç°ç¤ºä¾‹
async function initiatePayment(orderInfo) {
  try {
    // 1. è°ƒç”¨åç«¯åˆ›å»ºè®¢å•
    const order = await createOrder({
      amount: orderInfo.amount,
      merchantId: orderInfo.merchantId,
      userId: getUserId()
    })
    
    // 2. è·å–æ”¯ä»˜å‚æ•°
    const paymentParams = await getPaymentParams(order.orderId)
    
    // 3. è°ƒèµ·å¾®ä¿¡æ”¯ä»˜
    const payResult = await wx.requestPayment({
      timeStamp: paymentParams.timeStamp,
      nonceStr: paymentParams.nonceStr,
      package: paymentParams.package,
      signType: paymentParams.signType,
      paySign: paymentParams.paySign
    })
    
    // 4. æ”¯ä»˜æˆåŠŸå¤„ç†
    if (payResult.errMsg === 'requestPayment:ok') {
      // æŸ¥è¯¢æ”¯ä»˜ç»“æœ
      const result = await verifyPayment(order.orderId)
      return result
    }
    
  } catch (error) {
    // æ”¯ä»˜å¤±è´¥å¤„ç†
    if (error.errMsg === 'requestPayment:fail cancel') {
      throw new Error('ç”¨æˆ·å–æ¶ˆæ”¯ä»˜')
    }
    throw error
  }
}
```

---

## ğŸ›¡ å®‰å…¨è§„èŒƒ

### 1. æ•°æ®å®‰å…¨è¦æ±‚

#### æ•æ„Ÿæ•°æ®å¤„ç†
```javascript
// æ•æ„Ÿæ•°æ®ç±»å‹
const sensitiveDataTypes = [
  'æ‰‹æœºå·ç ',
  'èº«ä»½è¯å·',
  'é“¶è¡Œå¡å·',
  'å¯†ç ',
  'æ”¯ä»˜ä¿¡æ¯',
  'ä½ç½®ä¿¡æ¯'
]

// æ•°æ®åŠ å¯†ç¤ºä¾‹
class SecurityManager {
  // æ•æ„Ÿæ•°æ®åŠ å¯†ä¼ è¾“
  static encryptSensitiveData(data) {
    // ä½¿ç”¨å°ç¨‹åºæä¾›çš„åŠ å¯†æ–¹æ³•
    return wx.getStorageSync('encryptKey') 
      ? this.aesEncrypt(data)
      : data
  }
  
  // æ•°æ®è„±æ•æ˜¾ç¤º
  static maskSensitiveInfo(type, value) {
    switch(type) {
      case 'phone':
        return value.replace(/(\d{3})\d{4}(\d{4})/, '$1****$2')
      case 'idCard':
        return value.replace(/(\d{6})\d{8}(\d{4})/, '$1********$2')
      case 'bankCard':
        return value.replace(/(\d{4})\d+(\d{4})/, '$1 **** **** $2')
      default:
        return value
    }
  }
  
  // HTTPSå¼ºåˆ¶æ£€æŸ¥
  static checkHttps(url) {
    if (!url.startsWith('https://')) {
      throw new Error('å¿…é¡»ä½¿ç”¨HTTPSåè®®')
    }
    return true
  }
}
```

### 2. ç”¨æˆ·æˆæƒè§„èŒƒ

#### æˆæƒæµç¨‹ç®¡ç†
```javascript
// æˆæƒç±»å‹
const authScopes = {
  'scope.userInfo': 'ç”¨æˆ·ä¿¡æ¯',
  'scope.userLocation': 'åœ°ç†ä½ç½®',
  'scope.userLocationBackground': 'åå°å®šä½',
  'scope.werun': 'å¾®ä¿¡è¿åŠ¨æ­¥æ•°',
  'scope.record': 'å½•éŸ³åŠŸèƒ½',
  'scope.writePhotosAlbum': 'ä¿å­˜åˆ°ç›¸å†Œ',
  'scope.camera': 'æ‘„åƒå¤´'
}

// æˆæƒç®¡ç†å™¨
class AuthManager {
  // æ£€æŸ¥å¹¶è¯·æ±‚æˆæƒ
  static async requireAuth(scope) {
    const authSetting = await wx.getSetting()
    
    if (authSetting.authSetting[scope] === false) {
      // å·²æ‹’ç»ï¼Œå¼•å¯¼æ‰“å¼€è®¾ç½®
      const modal = await wx.showModal({
        title: 'æˆæƒæç¤º',
        content: `éœ€è¦æ‚¨çš„${authScopes[scope]}æˆæƒæ‰èƒ½ä½¿ç”¨æ­¤åŠŸèƒ½`,
        confirmText: 'å»è®¾ç½®'
      })
      
      if (modal.confirm) {
        const setting = await wx.openSetting()
        return setting.authSetting[scope]
      }
      return false
    }
    
    // è¯·æ±‚æˆæƒ
    try {
      await wx.authorize({ scope })
      return true
    } catch (error) {
      return false
    }
  }
  
  // è·å–ç”¨æˆ·ä¿¡æ¯æœ€ä½³å®è·µ
  static async getUserProfile() {
    // å¿…é¡»é€šè¿‡ç‚¹å‡»äº‹ä»¶è§¦å‘
    const result = await wx.getUserProfile({
      desc: 'ç”¨äºå®Œå–„ç”¨æˆ·èµ„æ–™'
    })
    
    // åŠ å¯†å­˜å‚¨
    this.saveUserInfo(result.userInfo)
    return result.userInfo
  }
}
```

---

## ğŸ“± UI/UXè§„èŒƒ

### 1. ç•Œé¢è®¾è®¡è§„èŒƒ

#### å°ºå¯¸å’Œé€‚é…
```css
/* è®¾è®¡ç¨¿åŸºå‡†ï¼šiPhone 6 (375 x 667) */
/* ä½¿ç”¨rpxä½œä¸ºå°ºå¯¸å•ä½ï¼Œè‡ªåŠ¨é€‚é…ä¸åŒå±å¹• */

/* å¸¸ç”¨ç»„ä»¶å°ºå¯¸è§„èŒƒ */
.button-primary {
  height: 88rpx;
  font-size: 32rpx;
  border-radius: 8rpx;
}

.list-item {
  height: 100rpx;
  padding: 0 30rpx;
  font-size: 30rpx;
}

.input-field {
  height: 80rpx;
  padding: 0 20rpx;
  font-size: 28rpx;
}

/* å®‰å…¨åŒºåŸŸé€‚é… */
.safe-area-bottom {
  padding-bottom: constant(safe-area-inset-bottom);
  padding-bottom: env(safe-area-inset-bottom);
}
```

#### äº¤äº’å“åº”è§„èŒƒ
```javascript
// æ“ä½œåé¦ˆæ—¶æ•ˆ
const interactionTiming = {
  tapFeedback: 100,      // ç‚¹å‡»åé¦ˆ < 100ms
  pageTransition: 300,   // é¡µé¢åˆ‡æ¢ < 300ms
  loadingDisplay: 500,   // è¶…è¿‡500msæ˜¾ç¤ºloading
  toastDuration: 1500    // toastæ˜¾ç¤ºæ—¶é•¿
}

// Loadingç®¡ç†
class LoadingManager {
  static show(title = 'åŠ è½½ä¸­...') {
    wx.showLoading({
      title,
      mask: true  // é˜²æ­¢æ“ä½œç©¿é€
    })
  }
  
  static hide() {
    wx.hideLoading()
  }
  
  // è‡ªåŠ¨loadingè£…é¥°å™¨
  static withLoading(fn, title) {
    return async function(...args) {
      LoadingManager.show(title)
      try {
        return await fn.apply(this, args)
      } finally {
        LoadingManager.hide()
      }
    }
  }
}
```

### 2. æ€§èƒ½ä¼˜åŒ–è§„èŒƒ

#### å¯åŠ¨æ€§èƒ½ä¼˜åŒ–
```javascript
// å¯åŠ¨ä¼˜åŒ–ç­–ç•¥
const launchOptimization = {
  // 1. å‡å°‘åŒæ­¥æ“ä½œ
  async onLaunch() {
    // å¼‚æ­¥æ“ä½œä¸é˜»å¡å¯åŠ¨
    this.initializeAsync()
    
    // å¿…è¦çš„åŒæ­¥æ“ä½œ
    this.checkAuth()
  },
  
  // 2. å»¶è¿ŸåŠ è½½
  async initializeAsync() {
    // å»¶è¿Ÿåˆå§‹åŒ–éå…³é”®æœåŠ¡
    setTimeout(() => {
      this.initAnalytics()
      this.preloadResources()
    }, 3000)
  },
  
  // 3. é¢„åŠ è½½å…³é”®æ•°æ®
  preloadCriticalData() {
    // é¢„åŠ è½½é¦–é¡µæ•°æ®
    const homeData = wx.getStorageSync('homeCache')
    if (homeData) {
      this.globalData.homeData = homeData
    }
  }
}

// æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–
const renderOptimization = {
  // 1. é•¿åˆ—è¡¨ä¼˜åŒ–
  listOptimization: {
    useVirtualList: true,
    pageSize: 20,
    recycleView: true
  },
  
  // 2. å›¾ç‰‡ä¼˜åŒ–
  imageOptimization: {
    lazyLoad: true,
    showMenuByLongpress: false,
    webp: true
  },
  
  // 3. setDataä¼˜åŒ–
  setDataOptimization(data) {
    // åªæ›´æ–°å˜åŒ–çš„æ•°æ®
    const changedData = {}
    for (const key in data) {
      if (this.data[key] !== data[key]) {
        changedData[key] = data[key]
      }
    }
    
    // åˆ†æ‰¹æ›´æ–°å¤§æ•°æ®
    if (Object.keys(changedData).length > 10) {
      this.setDataInBatches(changedData)
    } else {
      this.setData(changedData)
    }
  }
}
```

---

## ğŸš« å®¡æ ¸æ³¨æ„äº‹é¡¹

### 1. å¸¸è§å®¡æ ¸æ‹’ç»åŸå› 

#### åŠŸèƒ½å®Œæ•´æ€§
```markdown
âŒ å¸¸è§é—®é¢˜ï¼š
1. åŠŸèƒ½æœªå®Œæˆæˆ–å­˜åœ¨æ˜æ˜¾bug
2. é¡µé¢æ— æ³•æ­£å¸¸åŠ è½½
3. æŒ‰é’®ç‚¹å‡»æ— å“åº”
4. æ”¯ä»˜æµç¨‹æ— æ³•å®Œæˆ

âœ… è§£å†³æ–¹æ¡ˆï¼š
1. å®Œæ•´æµ‹è¯•æ‰€æœ‰åŠŸèƒ½æµç¨‹
2. æä¾›æµ‹è¯•è´¦å·å’Œè¯¦ç»†è¯´æ˜
3. ç¡®ä¿æ‰€æœ‰é¡µé¢å¯è®¿é—®
4. å¼‚å¸¸æƒ…å†µæœ‰å‹å¥½æç¤º
```

#### å†…å®¹åˆè§„æ€§
```markdown
âŒ è¿è§„å†…å®¹ç±»å‹ï¼š
1. è¯±å¯¼åˆ†äº«ã€è¯±å¯¼å…³æ³¨
2. è™šå‡å®£ä¼ ã€å¤¸å¤§åŠŸèƒ½
3. è¿æ³•è¿è§„å†…å®¹
4. ä¾µçŠ¯ä»–äººæƒç›Š

âœ… å†…å®¹è§„èŒƒï¼š
1. åŠŸèƒ½æè¿°çœŸå®å‡†ç¡®
2. ä¸ä½¿ç”¨ç»å¯¹åŒ–ç”¨è¯­
3. éµå®ˆå¹¿å‘Šæ³•è§„å®š
4. å°Šé‡çŸ¥è¯†äº§æƒ
```

#### ç”¨æˆ·ä½“éªŒ
```markdown
âŒ ä½“éªŒé—®é¢˜ï¼š
1. å¼ºåˆ¶ç™»å½•æ‰èƒ½ä½¿ç”¨
2. è¿‡åº¦æ”¶é›†ç”¨æˆ·ä¿¡æ¯
3. å¹¿å‘Šè¿‡å¤šå½±å“ä½¿ç”¨
4. æ“ä½œæµç¨‹è¿‡äºå¤æ‚

âœ… ä½“éªŒä¼˜åŒ–ï¼š
1. æ ¸å¿ƒåŠŸèƒ½å…ç™»å½•
2. æŒ‰éœ€è·å–ç”¨æˆ·æˆæƒ
3. å¹¿å‘Šå±•ç¤ºå…‹åˆ¶åˆç†
4. æ“ä½œæµç¨‹ç®€æ´æ˜äº†
```

### 2. å®¡æ ¸ææ–™å‡†å¤‡

#### å¿…å¤‡ææ–™æ¸…å•
```markdown
åŸºç¡€ææ–™ï¼š
- [ ] è¥ä¸šæ‰§ç…§
- [ ] æ³•äººèº«ä»½è¯æ˜
- [ ] å•†æ ‡æ³¨å†Œè¯ï¼ˆå¦‚æ¶‰åŠï¼‰
- [ ] è½¯ä»¶è‘—ä½œæƒè¯ä¹¦ï¼ˆå¦‚æ¶‰åŠï¼‰

ç‰¹æ®Šèµ„è´¨ï¼š
- [ ] æ”¯ä»˜ä¸šåŠ¡è®¸å¯è¯
- [ ] é‡‘èä¸šåŠ¡èµ„è´¨
- [ ] åŒ»ç–—ç›¸å…³èµ„è´¨
- [ ] æ•™è‚²ç›¸å…³èµ„è´¨

æµ‹è¯•ææ–™ï¼š
- [ ] æµ‹è¯•è´¦å·å¯†ç 
- [ ] æµ‹è¯•æµç¨‹è¯´æ˜
- [ ] åŠŸèƒ½æ¼”ç¤ºè§†é¢‘
- [ ] ç‰¹æ®Šè¯´æ˜æ–‡æ¡£
```

---

## ğŸ“Š ç›‘æ§å’Œåˆ†æ

### 1. å°ç¨‹åºæ•°æ®åˆ†æ

#### å…³é”®æŒ‡æ ‡ç›‘æ§
```javascript
// è‡ªå®šä¹‰äº‹ä»¶ä¸ŠæŠ¥
class Analytics {
  // é¡µé¢è®¿é—®ç»Ÿè®¡
  static trackPageView(pagePath, options = {}) {
    wx.reportAnalytics('page_view', {
      page_path: pagePath,
      page_title: options.title || '',
      user_id: getUserId(),
      timestamp: Date.now()
    })
  }
  
  // äº‹ä»¶è¿½è¸ª
  static trackEvent(eventName, params = {}) {
    wx.reportAnalytics(eventName, {
      ...params,
      user_id: getUserId(),
      timestamp: Date.now(),
      app_version: getAppVersion()
    })
  }
  
  // æ€§èƒ½ç›‘æ§
  static trackPerformance() {
    const performance = wx.getPerformance()
    const metrics = {
      launch_time: performance.launchTime,
      first_paint: performance.firstPaint,
      first_contentful_paint: performance.firstContentfulPaint,
      dom_ready: performance.domReady
    }
    
    this.trackEvent('performance_metrics', metrics)
  }
}
```

### 2. é”™è¯¯ç›‘æ§

#### å¼‚å¸¸æ•è·å’Œä¸ŠæŠ¥
```javascript
// å…¨å±€é”™è¯¯å¤„ç†
App({
  onError(error) {
    // é”™è¯¯ä¸ŠæŠ¥
    this.reportError({
      type: 'jsError',
      error: error.toString(),
      stack: error.stack,
      page: getCurrentPages().pop()?.route,
      userInfo: this.globalData.userInfo
    })
  },
  
  onPageNotFound(res) {
    // 404å¤„ç†
    this.reportError({
      type: 'pageNotFound',
      path: res.path,
      query: res.query
    })
    
    // é‡å®šå‘åˆ°é¦–é¡µ
    wx.switchTab({
      url: '/pages/index/index'
    })
  },
  
  // ç»Ÿä¸€é”™è¯¯ä¸ŠæŠ¥
  reportError(errorInfo) {
    // æ”¶é›†ç¯å¢ƒä¿¡æ¯
    const systemInfo = wx.getSystemInfoSync()
    const networkType = wx.getNetworkType()
    
    const report = {
      ...errorInfo,
      app_version: this.version,
      system_info: systemInfo,
      network_type: networkType,
      timestamp: Date.now()
    }
    
    // ä¸ŠæŠ¥åˆ°ç›‘æ§å¹³å°
    wx.request({
      url: 'https://api.example.com/error/report',
      method: 'POST',
      data: report
    })
  }
})
```

---

## ğŸ”§ å¼€å‘å·¥å…·å’Œè°ƒè¯•

### 1. å¼€å‘è€…å·¥å…·è®¾ç½®

#### æ¨èé…ç½®
```json
// project.config.json
{
  "setting": {
    "urlCheck": true,         // åŸŸåæ ¡éªŒ
    "es6": true,             // ES6è½¬ES5
    "enhance": true,         // å¢å¼ºç¼–è¯‘
    "postcss": true,         // æ ·å¼è¡¥å…¨
    "preloadBackgroundData": false,
    "minified": true,        // å‹ç¼©ä»£ç 
    "newFeature": true,
    "coverView": true,
    "nodeModules": true,
    "autoAudits": true,      // è‡ªåŠ¨ä½“éªŒè¯„åˆ†
    "showShadowRootInWxmlPanel": true,
    "scopeDataCheck": false,
    "uglifyFileName": false,
    "checkInvalidKey": true,
    "checkSiteMap": true,
    "uploadWithSourceMap": true,
    "compileHotReLoad": true,
    "useMultiFrameRuntime": true,
    "useApiHook": true,
    "useApiHostProcess": true,
    "babelSetting": {
      "ignore": [],
      "disablePlugins": [],
      "outputPath": ""
    }
  }
}
```

### 2. çœŸæœºè°ƒè¯•æŠ€å·§

#### è°ƒè¯•æ–¹æ³•é›†åˆ
```javascript
// æ¡ä»¶ç¼–è¯‘
const DEBUG = __wxConfig.envVersion === 'develop'

// è°ƒè¯•å·¥å…·ç±»
class DebugHelper {
  // vconsoleé›†æˆ
  static enableVConsole() {
    if (DEBUG) {
      wx.setEnableDebug({
        enableDebug: true
      })
    }
  }
  
  // æ€§èƒ½é¢æ¿
  static showPerformancePanel() {
    if (DEBUG) {
      wx.showPerformancePanel({
        enable: true
      })
    }
  }
  
  // æ—¥å¿—ç®¡ç†
  static log(...args) {
    if (DEBUG) {
      console.log('[DEBUG]', ...args)
      // ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶
      this.saveToLogFile(args)
    }
  }
  
  // ç½‘ç»œè¯·æ±‚ç›‘æ§
  static monitorNetwork() {
    const originalRequest = wx.request
    wx.request = function(options) {
      const startTime = Date.now()
      const originalSuccess = options.success
      const originalFail = options.fail
      
      options.success = function(res) {
        const duration = Date.now() - startTime
        DebugHelper.log('Request Success', {
          url: options.url,
          duration,
          status: res.statusCode
        })
        originalSuccess && originalSuccess(res)
      }
      
      options.fail = function(err) {
        DebugHelper.log('Request Fail', {
          url: options.url,
          error: err
        })
        originalFail && originalFail(err)
      }
      
      return originalRequest(options)
    }
  }
}
```

---

## ğŸ“ æœ€ä½³å®è·µæ€»ç»“

### å¼€å‘æµç¨‹å»ºè®®
1. **æ¶æ„è®¾è®¡é˜¶æ®µ**
   - å……åˆ†è€ƒè™‘å°ç¨‹åºé™åˆ¶
   - åˆç†è§„åˆ’åˆ†åŒ…ç»“æ„
   - è®¾è®¡ç¼“å­˜ç­–ç•¥

2. **å¼€å‘å®æ–½é˜¶æ®µ**
   - éµå¾ªå®˜æ–¹è§„èŒƒ
   - æ³¨é‡æ€§èƒ½ä¼˜åŒ–
   - åšå¥½é”™è¯¯å¤„ç†

3. **æµ‹è¯•å‘å¸ƒé˜¶æ®µ**
   - å®Œæ•´åŠŸèƒ½æµ‹è¯•
   - å¤šæœºå‹å…¼å®¹æµ‹è¯•
   - å‡†å¤‡å……åˆ†çš„å®¡æ ¸ææ–™

4. **è¿è¥ç»´æŠ¤é˜¶æ®µ**
   - æŒç»­ç›‘æ§æ€§èƒ½
   - æ”¶é›†ç”¨æˆ·åé¦ˆ
   - åŠæ—¶ä¿®å¤é—®é¢˜

### èµ„æºé“¾æ¥
- [å¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [å¾®ä¿¡æ”¯ä»˜å¼€å‘æ–‡æ¡£](https://pay.weixin.qq.com/wiki/doc/api/index.html)
- [å°ç¨‹åºè®¾è®¡è§„èŒƒ](https://developers.weixin.qq.com/miniprogram/design/)
- [è¿è¥è§„èŒƒ](https://developers.weixin.qq.com/miniprogram/product/)

---

**æ–‡æ¡£çŠ¶æ€**ï¼šæŒç»­æ›´æ–°ä¸­  
**æœ€åæ›´æ–°**ï¼š2024å¹´12æœˆ  
**ç»´æŠ¤å›¢é˜Ÿ**ï¼šæŠ€æœ¯å¼€å‘å›¢é˜Ÿ
